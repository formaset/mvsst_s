{% extends "base.html" %}
{% load static %}
{% block title %}{{ site.site_title|default:"Главная" }}{% endblock %}
{% block content %}

<section class="hero" {% if site.hero_image %}style="background-image: url('{{ site.hero_image.url }}');"{% endif %}>
    <div class="hero__overlay"></div>
    <div class="row hero__content">
        <div class="column large-7 medium-10 tab-12">
            {% if site.tagline %}
                <span class="hero__eyebrow">{{ site.tagline }}</span>
            {% endif %}
            <h1 class="hero__title">
                {{ site.hero_title|default:site.organization_name|default:"АНО «МосводостокСтройТрест»" }}
            </h1>
            {% if site.hero_subtitle %}
                <p class="hero__subtitle">{{ site.hero_subtitle }}</p>
            {% endif %}
            <div class="hero__actions">
                <a class="btn hero__btn" href="{% url 'core:organization_about' %}">Об организации</a>
                <a class="btn btn--ghost hero__btn" href="{% url 'core:contact' %}">Контакты</a>
            </div>
        </div>
    </div>
</section>

<section class="section section--light">
    <div class="row">
        <div class="column large-6 tab-12">
            <h2 class="section__title">{{ site.home_about_title|default:"Об организации" }}</h2>
        </div>
        <div class="column large-6 tab-12">
            {% if site.home_about_text %}
                <div class="section__text">{{ site.home_about_text|safe }}</div>
            {% else %}
                <p>Добавьте краткое описание организации в админке: Настройки сайта → Главная.</p>
            {% endif %}
            <a class="link-arrow" href="{% url 'core:organization_about' %}">Подробнее об организации</a>
        </div>
    </div>
</section>

<section class="section section--facts">
    <div class="row">
        <div class="column large-12">
            <h2 class="section__title">Ключевые факты</h2>
        </div>
    </div>
    <div class="row facts">
        {% for fact in key_facts %}
        <div class="column large-3 medium-6 tab-12">
            <div class="fact-card">
                <div class="fact-card__value">{{ fact.value }}</div>
                <div class="fact-card__title">{{ fact.title }}</div>
                {% if fact.description %}
                    <div class="fact-card__description">{{ fact.description }}</div>
                {% endif %}
            </div>
        </div>
        {% empty %}
        <div class="column large-12">
            <p>Добавьте ключевые факты в админке: Ключевые факты.</p>
        </div>
        {% endfor %}
    </div>
</section>

<section class="section section--news">
    <div class="row">
        <div class="column large-12">
            <div class="section__header">
                <h2 class="section__title">Новости</h2>
                <a class="btn btn--ghost" href="{% url 'blog:index' %}">Все новости</a>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="column large-12">
            <div class="news-list">
                {% for post in latest_posts %}
                <article class="news-card">
                    <a class="news-card__media" href="{{ post.get_absolute_url }}">
                        {% if post.cover %}
                            <img src="{{ post.cover.url }}" alt="{{ post.title }}">
                        {% else %}
                            <img src="{% static 'theme/images/sample-1050.jpg' %}" alt="{{ post.title }}">
                        {% endif %}
                    </a>
                    <div class="news-card__content">
                        {% if post.published_at %}
                            <time class="news-card__date" datetime="{{ post.published_at|date:'Y-m-d' }}">
                                {{ post.published_at|date:"d.m.Y" }}
                            </time>
                        {% endif %}
                        <h3 class="news-card__title">
                            <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
                        </h3>
                        {% if post.excerpt %}
                            <p class="news-card__excerpt">{{ post.excerpt|striptags|truncatechars:170 }}</p>
                        {% endif %}
                        <a class="link-arrow" href="{{ post.get_absolute_url }}">Читать новость</a>
                    </div>
                </article>
                {% empty %}
                <p>Пока нет опубликованных новостей.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

{% endblock %}
